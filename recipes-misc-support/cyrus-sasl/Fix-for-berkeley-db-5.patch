From f0a465e77a55bef32eceab6f984b3d405fe70464 Mon Sep 17 00:00:00 2001
From: Samuel Stirtzel <s.stirtzel@googlemail.com>
Date: Fri, 15 Jun 2012 10:57:51 +0200
Subject: [PATCH] Fix for berkeley db 5

Original author: John Burrell <john_burrell@hotmail.com>
Signed-off-by: Samuel Stirtzel <s.stirtzel@googlemail.com>
---
 sasldb/db_berkeley.c  |    2 +-
 utils/dbconverter-2.c |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/sasldb/db_berkeley.c b/sasldb/db_berkeley.c
index 00cf1ac..dc5a87a 100644
--- a/sasldb/db_berkeley.c
+++ b/sasldb/db_berkeley.c
@@ -85,7 +85,7 @@ static int berkeleydb_open(const sasl_utils_t *utils,
     ret = db_create(mbdb, NULL, 0);
     if (ret == 0 && *mbdb != NULL)
     {
-#if DB_VERSION_MAJOR == 4 && DB_VERSION_MINOR >= 1
+#if (DB_VERSION_MAJOR == 4 && DB_VERSION_MINOR >= 1) || DB_VERSION_MAJOR == 5
 	ret = (*mbdb)->open(*mbdb, NULL, path, NULL, DB_HASH, flags, 0660);
 #else
 	ret = (*mbdb)->open(*mbdb, path, NULL, DB_HASH, flags, 0660);
diff --git a/utils/dbconverter-2.c b/utils/dbconverter-2.c
index d188e00..784f8a4 100644
--- a/utils/dbconverter-2.c
+++ b/utils/dbconverter-2.c
@@ -214,7 +214,7 @@ static int berkeleydb_open(const char *path,DB **mbdb)
     ret = db_create(mbdb, NULL, 0);
     if (ret == 0 && *mbdb != NULL)
     {
-#if DB_VERSION_MAJOR == 4 && DB_VERSION_MINOR >= 1
+#if (DB_VERSION_MAJOR == 4 && DB_VERSION_MINOR >= 1) || DB_VERSION_MAJOR == 5
 	ret = (*mbdb)->open(*mbdb, NULL, path, NULL, DB_HASH, DB_CREATE, 0664);
 #else
 	ret = (*mbdb)->open(*mbdb, path, NULL, DB_HASH, DB_CREATE, 0664);
-- 
1.7.9.5

